<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>
    <head>
        <title>Login Page</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link href="fb-login.css" rel="stylesheet">
        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>  
        <!--        <script src="fb-login.js"></script>-->
    </head>
    <body>
        <button id="big-fb-login" class="btn-facebook btn big-fb-btn">Login dengan Facebook</button>
        <div id="fb-root"></div>
        <script>
            $(function() {
                $("#big-fb-login").bind("click", function() {
                    var id = this.id;
                    if ($("#fxLoader").size() >= 0) {
                        $("#fxLoader").remove();
                        createLoaderLayer("Login dengan akun Facebook.")
                    }
                    loader();
                    $("#boxLoader").css("width", "400px");
                    $("#fxLoader").css("background-color", "rgba(0,0,0,0.7)");
        
                    FB.login(handleSessionResponse, {
                        scope: "offline_access,read_stream,publish_stream,email,user_status,user_interests"
                    });
                    
                    return true
                });
            });
            // Additional JS functions here
            window.fbAsyncInit = function() {
                FB.init({
                    appId      : '110842935626103', // App ID
                    channelUrl : 'http://distroit.16mb.com/channel.html', // Channel File
                    status     : true, // check login status
                    cookie     : true, // enable cookies to allow the server to access the session
                    xfbml      : true  // parse XFBML
                });

                // Additional init code here
                FB.getLoginStatus(handleSessionResponse)

            };

            // Load the SDK Asynchronously
            (function(d){
                var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
                if (d.getElementById(id)) {return;}
                js = d.createElement('script'); js.id = id; js.async = true;
                js.src = "//connect.facebook.net/en_US/all.js";
                ref.parentNode.insertBefore(js, ref);
            }(document));
            
            function handleSessionResponse(response) {
                if (response.status === 'connected') {
                    // connected
                    console.log('connected');
                    if (response.authResponse.userID) {
                        console.log(response.authResponse.userID);
                        loaded();
                    }else{
                        console.log(response.authResponse.userID);
                        loaded();
                    }
                } else if (response.status === 'not_authorized') {
                    // not_authorized
                    console.log('not_authorized');
                    loaded();
                } else {
                    // not_logged_in
                    console.log('not_logged_in');
                    loaded();
                }
            }
            function writeCookie(cookieName, cookieValue, expireHours, path, domain){ 
                var date =  new Date(); 
                date.setHours(date.getHours + expireHours); 
                document.cookie = cookieName+'='+ 
                    cookieValue+'; expires='+date+'; path='+ 
                    path+'; domain='+domain; 
            }
            function readCookie(cookieName){ 
                var textArray = document.cookie.split(';'); 
                for(var i = 0; i < textArray.length; i++){ 
                    var textPiece = textArray[i]; 
                    while(textPiece(0)==' ') 
                        textPiece = textPiece.substring(1,textPiece.length); 
                    if (textPiece.indexOf(cookieName)== 0) 
                        return textPiece.substring(cookieName.length,c.length); 
                } 
            }
            function createLoaderLayer(customMessage) {
                var message = (typeof customMessage == "undefined") ? "menyimpan": customMessage;
                $("body").append('<div id="fxLoader" align="center" style="display:none;"><div id="boxLoader"><table><tr><td width="24"></td><td style="padding: 3px 0 0 10px;">' + message + "</td></tr></table></div></div>")
            }
            function loader() {
                $("#fxLoader").css({
                    position: "fixed",
                    top: 0,
                    width: "100%",
                    height: "100%"
                });
                $("#boxLoader").css({
                    padding: "4px 0",
                    width: "200px",
                    color: "#FFFFFF",
                    "font-weight": "bold"
                }).addClass("ui-corner-bl").addClass("ui-corner-br");
                $("#fxLoader").show()
            }
            function loaded() {
                $("#fxLoader").fadeOut()
            }
            function updateStatus(){
                var body = 'JS SDK';
                FB.api('/me/feed', 'post', { message: body }, function(response) {
                    if (!response || response.error) {
                        alert('Error occured');
                    } else {
                        alert('Post ID: ' + response.id);
                    }
                });
            }
        </script>
    </body>
</html>